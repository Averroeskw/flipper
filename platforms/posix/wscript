# Platform build script.

# Target: POSIX

def configure(cfg):
    cfg.setenv('platform-posix')
    # Set the platform name.
    cfg.env.platform = 'posix'
    # Build modules for this platform.
    cfg.env.BUILD_MODULES = True
    # Set the platform flags.
    cfg.env.append_value('CFLAGS', ['-std=c99'])
    # Load the appropriate C compiler.
    cfg.load('compiler_c')
    # Check for and import libusb-1.0.
    cfg.check(lib = 'usb-1.0', mandatory = True, uselib_store = 'usb-1.0')

def build(bld):
    _env = bld.all_envs['platform-posix'].derive()
    bld.stlib(source = bld.path.ant_glob('src/**'), target = 'platform-posix', use = 'usb-1.0', env = _env)
