# Platform build script.

# Target: POSIX

def configure(cfg):
    cfg.setenv('platform-posix')
    # Set the platform name.
    cfg.env.platform = 'posix'
    # Build modules for this platform.
    cfg.env.BUILD_MODULES = True
    # Set the platform flags.
    cfg.env.append_value('CFLAGS', ['-std=c99'])
    # Check for libusb-1.0.
    cfg.check_cfg(package = 'libusb-1.0')
    # Load the appropriate C compiler.
    cfg.load('compiler_c')

def build(bld):
    # Find and load libusb-1.0.
    bld.read_shlib('usb-1.0')
    bld.stlib(source = bld.path.ant_glob('src/**'), target = 'platform-posix', use = 'usb-1.0', env = bld.all_envs['platform-posix'])
